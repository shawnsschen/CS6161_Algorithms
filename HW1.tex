%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Short Sectioned Assignment
% LaTeX Template
% Version 1.0 (5/5/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Frits Wenneker (http://www.howtotex.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[titlepage, paper=a4, fontsize=11pt]{scrartcl} % A4 paper and 11pt font size

\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\usepackage{fourier} % Use the Adobe Utopia font for the document - comment this line to return to the LaTeX default
\usepackage[english]{babel} % English language/hyphenation
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{listings}

\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template


\usepackage{sectsty} % Allows customizing section commands
\allsectionsfont{\centering \normalfont\scshape} % Make all sections centered, the default font and small caps

\usepackage{fancyhdr} % Custom headers and footers
\pagestyle{fancyplain} % Makes all pages in the document conform to the custom headers and footers
\fancyhead{} % No page header - if you want one, create it in the same way as the footers below
\fancyfoot[L]{} % Empty left footer
\fancyfoot[C]{} % Empty center footer
\fancyfoot[R]{\thepage} % Page numbering for right footer
\renewcommand{\headrulewidth}{0pt} % Remove header underlines
\renewcommand{\footrulewidth}{0pt} % Remove footer underlines
\setlength{\headheight}{13.6pt} % Customize the height of the header

\numberwithin{equation}{section} % Number equations within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{figure}{section} % Number figures within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{table}{section} % Number tables within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)

\setlength\parindent{0pt} % Removes all indentation from paragraphs - comment this line for an assignment with lots of text

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height

\title{	
\normalfont \normalsize 
\textsc{University of Virginia} \\ [25pt] % Your university, school and/or department name(s)
\horrule{0.5pt} \\[0.4cm] % Thin top horizontal rule
\huge CS 6161 Algorithms \\
\huge Homework 1 \\ % The assignment title
\horrule{2pt} \\[0.5cm] % Thick bottom horizontal rule
}

\author{Shawn (Shuoshuo) Chen\\sc7cq@virginia.edu} % Your name

\date{\normalsize\today} % Today's date or a custom date

\begin{document}

\maketitle % Print the title

%----------------------------------------------------------------------------------------
%	PROBLEM 1
%----------------------------------------------------------------------------------------

\section*{Problem 1}
\textbf{(a)}. According to Tardos book, under the case that $k = n$, there is \\
\begin{align*} 
\begin{split}
Pr[X_i > c] &< \left( \frac{e^{c-1}}{c} \right)^c < \left( \frac{e}{c} \right)^c = \left( \frac{1}{\gamma(n)} \right)^{e\gamma(n)} < \left( \frac{1}{\gamma(n)} \right)^{2\gamma(n)} = \frac{1}{n^2}
\end{split}					
\end{align*}
By definition, $X_i$ is $|B(j)|$. Thus \\
\begin{align*} 
\begin{split}
Pr[ \ |B(j)| > c \ ] &< \frac{1}{n^2} \ \bigg|_{c \ = \ \Theta(\frac{log(n)}{loglog(n)})}
\end{split}					
\end{align*}
Applying the union bound over this upper bound for $|B(1)|, |B(2)|, ..., |B(n)|$, there is following \\
\begin{align*} 
\begin{split}
Pr[ \ |B(*)| > c \ ] &< \frac{1}{n} \ \bigg|_{c \ = \ \Theta(\frac{log(n)}{loglog(n)})}
\end{split}					
\end{align*}
In words, it means that with probability at least $1 - \frac{1}{n}$, $max_j\{|B(j)|\}$ will not exceed
$\Theta(\frac{log(n)}{loglog(n)})$.
\\

\textbf{(b)}. By definition, $|B(i)| = Y = \sum_{j \in [n]} Y_j$, thus $Var[|B(i)|] = Var[Y]$. And there is \\
\begin{align*} 
\begin{split}
Var[Y] &= \mathbb{E}[Y^2] - (\mathbb{E}[Y])^2 \\
&= \mathbb{E}[(\sum_{j \in [n]} Y_j)^2] - (\mathbb{E}[\sum_{j \in [n]} Y_j])^2 \\
&= \mathbb{E}[(\sum_{j \in [n]} Y_j)^2] - (\sum_{j \in [n]} \mathbb{E}[Y_j])^2 \\
&= \mathbb{E}[(\sum_{j \in [n]} Y_j)^2] - n \times \frac{1}{n} \\
&= \mathbb{E}[\sum_{j \in [n]}\sum_{i \in [n]} Y_iY_j] - 1 \\
&= \mathbb{E}[\sum_{j \in [n]} Y_i^2 + \sum_{j \in [n]}\sum_{i \in [n], i \neq j} Y_iY_j] - 1 \\
&= \sum_{j \in [n]}\mathbb{E}[Y_i^2] + \sum_{j \in [n]}\sum_{i \in [n], i \neq j}\mathbb{E}[Y_iY_j] -1 \\
&= \sum_{j \in [n]}\mathbb{E}[Y_i] + \sum_{j \in [n]}\sum_{i \in [n], i \neq j}\mathbb{E}[Y_i]\mathbb{E}[Y_j] -1 \\
&= n \times \frac{1}{n} + \frac{n(n-1)}{2} \times 2 \times \frac{1}{n^2} -1 \\
&= \frac{n-1}{n} \\
&= 1 - \frac{1}{n}
\end{split}					
\end{align*}
As we can see, with $n \to \infty$, $Var[Y] \to 1$. And for any $n$, $Var[Y] \leqslant 1$. \\
That is, $Var[|B(i)|] = O(1)$.
\\

\textbf{(c)}. The Chebyshev's inequality gives
\begin{align*} 
\begin{split}
Pr[|X-\mu| \geqslant k\delta] \leqslant \frac{1}{k^2}
\end{split}					
\end{align*}
We can replace $X = |B(j)|$, $\mu = 1$ and $\delta = \sqrt{\frac{n-1}{n}}$.
\begin{align*} 
\begin{split}
&Pr[|\ |B(j)|-1\ | \geqslant k\sqrt{\frac{n-1}{n}}] \leqslant \frac{1}{k^2} \\
&Pr[|B(j)| \geqslant 1+k\sqrt{\frac{n-1}{n}} \ or \ |B(j)| \leqslant 1-k\sqrt{\frac{n-1}{n}}] \leqslant \frac{1}{k^2} \\
&Pr[|B(j)| \geqslant 1+k\sqrt{\frac{n-1}{n}}] + Pr[|B(j)| \leqslant 1-k\sqrt{\frac{n-1}{n}}] \leqslant \frac{1}{k^2} \\
&Pr[|B(j)| \geqslant 1+k\sqrt{\frac{n-1}{n}}] + 0 \bigg|_{1-k\sqrt{\frac{n-1}{n}} \textless 0} \leqslant \frac{1}{k^2} \\
&Pr[|B(j)| \geqslant 1+k\sqrt{\frac{n-1}{n}}] \leqslant \frac{1}{k^2} \bigg|_{k \textgreater \sqrt{\frac{n}{n-1}}} \\
\end{split}					
\end{align*}
If we make $k^2 = 100n$, solve for k, we get $k = 10\sqrt{n}$. See that for $n \geqslant 2$, $10\sqrt{n} \textgreater \sqrt{\frac{n}{n-1}}$ holds. When $n = 1$, the input and output set both contain only one element, so essentially it becomes deterministic one-to-one mapping, the probability $Pr[|B(j)|>1]=0$.
We can make sure that condition $k \textgreater \sqrt{\frac{n}{n-1}}$ is satisfied. \\

Replace $k = 10\sqrt{n}$:
\begin{align*} 
\begin{split}
Pr[|B(j)| \geqslant 1+10\sqrt{n-1}] \leqslant \frac{1}{100n}
\end{split}					
\end{align*}
And it is easy to see that:
\begin{align*} 
\begin{split}
Pr[|B(j)| \textgreater c\sqrt{n}] \leqslant \frac{1}{100n} \ \bigg|_{c\sqrt{n} \ \textgreater \ 1+10\sqrt{n-1}}
\end{split}					
\end{align*}
Solve for c in $c\sqrt{n} \ \textgreater \ 1+10\sqrt{n-1}$, we get $c \textgreater \frac{1}{\sqrt{n}} + 10\sqrt{\frac{n-1}{n}}$. \\
Note that $c > 1 \ \bigg|_{n=1}$ and $c > 10 \ \bigg|_{n \to \infty}$. \\
To sum up, for every fixed $j \in [k=n]$, there is
\begin{align*} 
\begin{split}
Pr[|B(j)| \textgreater c\sqrt{n}] \leqslant \frac{1}{100n} \ \bigg|_{c \ \textgreater \ 10}
\end{split}					
\end{align*}
Applying the union bound over this upper bound for $|B(1)|, |B(2)|, ..., |B(n)|$, we get
\begin{align*} 
\begin{split}
Pr[\forall j \in [n]: |B(j)| \textgreater c\sqrt{n}] \leqslant \frac{1}{100} \ \bigg|_{c \ \textgreater \ 10}
\end{split}					
\end{align*}
Flip it over, we have
\begin{align*} 
\begin{split}
Pr[\forall j \in [n]: |B(j)| \leqslant c\sqrt{n}] \geqslant \frac{99}{100} \ \bigg|_{c \ \textgreater \ 10}
\end{split}					
\end{align*}
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 2
%----------------------------------------------------------------------------------------

\section*{Problem 2}
haha
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 3
%----------------------------------------------------------------------------------------

\section*{Problem 3}
haha
\\


%----------------------------------------------------------------------------------------
%	PROBLEM 4
%----------------------------------------------------------------------------------------

\section*{Problem 4}
First, to prove $P_A(M_1)P_A(M_2) \equiv P_A(M_1M_2) \quad (mod n)$.
\begin{align*} 
\begin{split}
P_A(M_1)P_A(M_2) &= (M_1^e \  mod \ n )(M_2^e \  mod \ n ) \\
&= (M_1^eM_2^e) \ mod \ n \\
&= (M_1M_2)^e \ mod \ n \\
&= P_A(M_1M_2)
\end{split}					
\end{align*}
Assume the message we want to crack is $M$, which is encrypted in $P_A(M)$.
We can pick a message $M_r \in \mathbb{Z}_n$ at random and make sure that $M_{r}^{-1} \ mod \ n$ exists.
Since $M_r \in \mathbb{Z}_n$, there should exist its unique multiplicative inverse $M_r^{-1}$. \\

Then encrypt $M_r$ to get $P_A(M_r)$. And use what we have proved to get
$P_A(MM_r) = P_A(M)P_A(M_r)$. \\

If an advesary can decrypt the messages from $\mathbb{Z}_n$ by $1\%$, it means the probability of success
is $p = 0.01$ to decrypt $P_A(MM_r)$ and get $MM_r \ mod \ n$. If the decryption attempt is successful,
we can thus compute $M_r^{-1} \ mod \ n$ and derive $M = (MM_r)M_r^{-1} \ mod \ n$. \\

Now let us discuss the probability of successful decryption. It is noted that the probability of successful decryption
for a single attempt is $p = 0.01$. Thus the failing probability for a single attempt is $1-p = 1- 0.01 = 0.99$.
We want to make the overall probability high when decrypting $M$, which implies we need to keep trying.
Assume we need to try $t$ times to decrypt $M$, the probability of success in $t$ times is
$P_{decrypt} = 1-0.99^t$. If "high probability" means $99\%$, solve for $t$:
\begin{align*} 
\begin{split}
P_{decrypt} &= 1 - 0.99^t \\
&= 0.99 \\
\end{split}					
\end{align*}
\begin{align*} 
\begin{split}
t &= \log_{0.99}(0.01) \\
&= 458.2
\end{split}					
\end{align*}
Thus we get $t = 459$.
\\


\end{document}
